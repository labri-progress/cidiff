Started by timer
Running as SYSTEM
[EnvInject] - Loading node environment variables.
Building remotely on sos-builder01-ubuntu16 (lin) in workspace /builds/workspace/casper
[WS-CLEANUP] Deleting project workspace...
[WS-CLEANUP] Deferred wipeout is used...
[WS-CLEANUP] Done
The recommended git tool is: NONE
No credentials specified
Wiping out workspace first.
Cloning the remote Git repository
Cloning repository https://github.com/Spirals-Team/casper.git
 > git init /builds/workspace/casper # timeout=10
Fetching upstream changes from https://github.com/Spirals-Team/casper.git
 > git --version # timeout=10
 > git --version # 'git version 2.7.4'
 > git fetch --tags --progress https://github.com/Spirals-Team/casper.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git config remote.origin.url https://github.com/Spirals-Team/casper.git # timeout=10
 > git config --add remote.origin.fetch +refs/heads/*:refs/remotes/origin/* # timeout=10
Avoid second fetch
 > git rev-parse refs/remotes/origin/master^{commit} # timeout=10
Checking out Revision aa8d5609b4e840c38387d3ad40de2967bd360089 (refs/remotes/origin/master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f aa8d5609b4e840c38387d3ad40de2967bd360089 # timeout=10
Commit message: "Merge pull request #5 from slarse/update-spoon-snapshot-repository"
 > git rev-list --no-walk aa8d5609b4e840c38387d3ad40de2967bd360089 # timeout=10
[casper] $ /bin/sh -xe /tmp/jenkins1583039715328281027.sh
+ curl https://spoon.gforge.inria.fr/jenkins/inject_spoon_snapshot.py
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100  2381  100  2381    0     0  26864      0 --:--:-- --:--:-- --:--:-- 27056
+ python3 -c #! /bin/python3
"""Script for injecting the latest SNAPSHOT version of Spoon into all pom.xml
files it finds in the curren tworking directory or any subdirectory.

Requires the ``defusedxml`` package to be installed separately.

This script is compatible with Python 3.5+
"""
import xml.etree.ElementTree as ET
import subprocess
import pathlib

from typing import Optional

SPOON_SNAPSHOT_REPO = """
<repository>
    <id>ow2.org-snapshot</id>
    <name>Maven Repository for Spoon Snapshots</name>
    <url>https://repository.ow2.org/nexus/content/repositories/snapshots/</url>
    <snapshots/>
</repository>
"""
MAVEN_NAMESPACE = "http://maven.apache.org/POM/4.0.0"
NAMESPACES = {"": MAVEN_NAMESPACE}

MAVEN_VERSIONS_COMMAND = "mvn -B -U versions:use-latest-versions -DallowSnapshots -Dincludes=fr.inria.gforge.spoon".split()
PURGE_LOCAL_REPO_COMMAND = "mvn -B -U dependency:purge-local-repository -DmanualInclude='fr.inria.gforge.spoon:spoon-core' -DsnapshotsOnly=true".split()


def main():
    ET.register_namespace("", MAVEN_NAMESPACE)
    pom_file = pathlib.Path("pom.xml")
    inject_snapshot_repo(pom_file)
    subprocess.run(MAVEN_VERSIONS_COMMAND, cwd=str(pom_file.parent))
    subprocess.run(PURGE_LOCAL_REPO_COMMAND, cwd=str(pom_file.parent))


def inject_snapshot_repo(pom_file: pathlib.Path) -> None:
    tree = ET.parse(str(pom_file))
    root = tree.getroot()

    repositories = root.find(in_maven_namespace("repositories"))
    if not repositories:
        repositories = ET.fromstring("<repositories></repositories>")
        root.append(repositories)

    snapshot_repo = ET.fromstring(SPOON_SNAPSHOT_REPO)
    snapshot_repo_url = snapshot_repo.find("url").text

    for repo in repositories.findall(in_maven_namespace("repository")):
        url = repo.find(in_maven_namespace("url")).text
        if url == snapshot_repo_url:
            return

    repositories.append(snapshot_repo)

    tree.write(str(pom_file))


def in_maven_namespace(tag: str) -> str:
    """Wrap the tag in the default Maven namespace.

    If porting this script to Python 3.6+, then this method can be removed and
    one can instead search with a default namespace like so:

    someElement.find(tag, namespaces={"": MAVEN_NAMESPACE})

    This does not appear to work in Python 3.5
    """
    return "{{{}}}{}".format(MAVEN_NAMESPACE, tag)


if __name__ == "__main__":
    main()
Picked up JAVA_TOOL_OPTIONS: -Dfile.encoding=UTF8
[INFO] Scanning for projects...
[WARNING] 
[WARNING] Some problems were encountered while building the effective model for fr.inria.spirals:casper:jar:0.1
[WARNING] 'build.plugins.plugin.version' for org.apache.maven.plugins:maven-compiler-plugin is missing. @ line 81, column 29
[WARNING] 
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING] 
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[WARNING] 
[INFO] Downloading from central: https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-metadata.xml
[INFO] Downloading from central: https://repo.maven.apache.org/maven2/org/codehaus/mojo/maven-metadata.xml
[INFO] Downloaded from central: https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-metadata.xml (14 kB at 24 kB/s)
[INFO] Downloaded from central: https://repo.maven.apache.org/maven2/org/codehaus/mojo/maven-metadata.xml (20 kB at 31 kB/s)
[INFO] Downloading from central: https://repo.maven.apache.org/maven2/org/codehaus/mojo/versions-maven-plugin/maven-metadata.xml
[INFO] Downloaded from central: https://repo.maven.apache.org/maven2/org/codehaus/mojo/versions-maven-plugin/maven-metadata.xml (835 B at 28 kB/s)
[INFO] 
[INFO] ----------------------< fr.inria.spirals:casper >-----------------------
[INFO] Building casper 0.1
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- versions-maven-plugin:2.8.1:use-latest-versions (default-cli) @ casper ---
[INFO] Major version changes allowed
[INFO] artifact fr.inria.gforge.spoon:spoon-core: checking for updates from ow2.org-snapshot
[INFO] artifact fr.inria.gforge.spoon:spoon-core: checking for updates from central
[INFO] Updated fr.inria.gforge.spoon:spoon-core:jar:7.0.0 to version 9.2.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  4.972 s
[INFO] Finished at: 2021-09-27T10:23:10+02:00
[INFO] ------------------------------------------------------------------------
Picked up JAVA_TOOL_OPTIONS: -Dfile.encoding=UTF8
[INFO] Scanning for projects...
[WARNING] 
[WARNING] Some problems were encountered while building the effective model for fr.inria.spirals:casper:jar:0.1
[WARNING] 'build.plugins.plugin.version' for org.apache.maven.plugins:maven-compiler-plugin is missing. @ line 81, column 29
[WARNING] 
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING] 
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[WARNING] 
[INFO] 
[INFO] ----------------------< fr.inria.spirals:casper >-----------------------
[INFO] Building casper 0.1
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- maven-dependency-plugin:2.8:purge-local-repository (default-cli) @ casper ---
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  1.313 s
[INFO] Finished at: 2021-09-27T10:23:13+02:00
[INFO] ------------------------------------------------------------------------
+ mvn clean test
Picked up JAVA_TOOL_OPTIONS: -Dfile.encoding=UTF8
[INFO] Scanning for projects...
[WARNING] 
[WARNING] Some problems were encountered while building the effective model for fr.inria.spirals:casper:jar:0.1
[WARNING] 'build.plugins.plugin.version' for org.apache.maven.plugins:maven-compiler-plugin is missing. @ line 81, column 29
[WARNING] 
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING] 
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[WARNING] 
[INFO] 
[INFO] ----------------------< fr.inria.spirals:casper >-----------------------
[INFO] Building casper 0.1
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ casper ---
[INFO] 
[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ casper ---
[WARNING] Using platform encoding (UTF8 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] skip non existing resourceDirectory /builds/workspace/casper/src/main/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ casper ---
[INFO] Changes detected - recompiling the module!
[WARNING] File encoding has not been set, using platform encoding UTF8, i.e. build is platform dependent!
[INFO] Compiling 80 source files to /builds/workspace/casper/target/classes
[WARNING] /builds/workspace/casper/src/main/java/bcu/transformer/processors/TargetAdder.java: Some input files use unchecked or unsafe operations.
[WARNING] /builds/workspace/casper/src/main/java/bcu/transformer/processors/TargetAdder.java: Recompile with -Xlint:unchecked for details.
[INFO] 
[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ casper ---
[WARNING] Using platform encoding (UTF8 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] Copying 1 resource
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ casper ---
[INFO] Changes detected - recompiling the module!
[WARNING] File encoding has not been set, using platform encoding UTF8, i.e. build is platform dependent!
[INFO] Compiling 2 source files to /builds/workspace/casper/target/test-classes
[INFO] 
[INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ casper ---
[INFO] Surefire report directory: /builds/workspace/casper/target/surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Picked up JAVA_TOOL_OPTIONS: -Dfile.encoding=UTF8
Running casper.CasperTest
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
2-->6
foo5(null).f
tab[0]
array[1]
array[2]
array[1]
array[2]
TargetModifier -->6 (failed:0)
2b-->8
null
createNullGhost()
1-->1
3-->1
4-->5
5-->3
compilation success: true
class loading with final remover :FooCasper
created null ghost class for FooCasper
created null ghost class for FooCasper
created null ghost class for FooCasper
created null ghost class for FooCasper
created null ghost class for FooCasper
created null ghost class for FooCasper
null
inception: null initialized null (FooCasper.java:28)
returned null in method foo2 (FooCasper.java:28)
returned null in method foo (FooCasper.java:23)
assigned null to g (FooCasper.java:14)
assigned null to f (FooCasper.java:15)
throws NPE at FooCasper.bug1(FooCasper.java:18)

created null ghost class for FooCasper
created null ghost class for FooCasper
created null ghost class for FooCasper
created null ghost class for FooCasper
created null ghost class for FooCasper
inception: assigned null to tab (FooCasper.java:87)
throws NPE at FooCasper.literal2(FooCasper.java:88)

FooCasper
java.lang.Thread.getStackTrace(Thread.java:1559)
2-->6
foo5(null).f
tab[0]
array[1]
array[2]
array[1]
array[2]
TargetModifier -->6 (failed:0)
2b-->8
null
createNullGhost()
new bcornu.nullmode.DebugInfo()
cannot resolve an assign
1-->2
3-->5
4-->5
5-->3
compilation success: true
null
inception: null initialized null (FooCasper.java:28)
returned null in method foo2 (FooCasper.java:28)
returned null in method foo (FooCasper.java:23)
assigned null to g (FooCasper.java:14)
assigned null to f (FooCasper.java:15)
throws NPE at FooCasper.bug1(FooCasper.java:18)

inception: assigned null to tab (FooCasper.java:87)
throws NPE at FooCasper.literal2(FooCasper.java:88)

class loading with final remover :casper.Foo
created null ghost class for casper.Foo
class loading with final remover :jav.lang.ObjectNullified
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 6.064 sec

Results :

Tests run: 3, Failures: 0, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  12.730 s
[INFO] Finished at: 2021-09-27T10:23:27+02:00
[INFO] ------------------------------------------------------------------------
Finished: SUCCESS
